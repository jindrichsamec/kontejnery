general:
  build_dir: frontend

machine:
  node:
    version: 7.6.0

dependencies:
  override:
    - yarn install

test:
  override:
    - yarn test

deployment:
  prod:
    branch: master
    commands:
      - yarn run build
      - aws s3 sync ./build s3://www.velkoobjemaky.cz/ --delete --region=eu-central-1 --acl=public-read
      - aws configure set preview.cloudfront true
      - aws cloudfront create-invalidation --distribution-id $AWS_DISTRIBUTION_ID --paths / /index.html
